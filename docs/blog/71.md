---
layout: default
title: tar 명령어
parent: Blog
grand_parent: Category
permalink: docs/category/blog/71
child_nav_order: desc
---
# tar
{: .no_toc}

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---
## 개요

> - tar usage
{: .new }

### tar Compress

```bash
# 일반적인 압축 방법
tar -cf archive.tar foo bar 
# 진행률 확인 가능한 압축 방법
tar -cf - /etc/xen-tools/ -P | pv -s $(du -sb /etc/xen-tools | awk '{print $1}') | gzip > xen.tar.gz
```

> - `-p`, `-t`, `-e`, `-r`, `-b` 옵션 생략가능
```bash
-p, --progress
Turn the progress bar on. If standard input is not a file and no size was given (with the -s modifier), the progress bar cannot indicate how close to completion the transfer is, so it will just move left and right to indicate that data is moving.
-t, --timer
Turn the timer on. This will display the total elapsed time that pv has been running for.
-e, --eta
Turn the ETA timer on. This will attempt to guess, based on previous transfer rates and the total data size, how long it will be before completion. This option will have no effect if the total data size cannot be determined.
-r, --rate
Turn the rate counter on. This will display the current rate of data transfer.
-b, --bytes
Turn the total byte counter on. This will display the total amount of data transferred so far.
```
>
{: .important }

### tar Decompress

```bash
# e.g tar
tar -xf archive.tar
# e.g 압축타입
  -j, --bzip2                filter the archive through bzip2
  -J, --xz                   filter the archive through xz
      --lzip                 filter the archive through lzip
      --lzma                 filter the archive through xz
      --lzop                 filter the archive through lzop
 
pv sample.txz | tar -Jxf - -C sample/
```

```bash
# Remote tar Decompress Local → Remote Directory Path(Push)
# `--strip-components=1` 옵션의 경우 e.g /root/directory/folder.tar.gz 압축되어 있는경우 /root 생략/directory/folder 부터 압축해제
pv ace.tar.gz | sshpass -p "qwe123" ssh 192.168.56.100 "tar --strip-components=1 -zxf - -C /mnt/backup"
```

```bash
find . -type f -regex ".*[0-9].tar$" -print0 | xargs -0 -I {} bash -c 'pv {} | sshpass -p "mail1234" ssh root@192.168.56.115 "tar --strip-components=1 -xvf - -C /root/tar" && rm -rf {}'
```
