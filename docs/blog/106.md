---
layout: default
title: Ansible builder
parent: Blog
grand_parent: Category
permalink: docs/category/blog/106
child_nav_order: desc
---
# Ansible builder
<details open markdown="block">
  <summary>
    Table of contents
  </summary>
  ## Table of contents
  {: .no_toc .text-delta }
1. TOC
{:toc}
</details>
---
## 개요

> - Ansible builder를 사용한 EE(Execution Environments) 이미지 만들기
> - [ansible-builder](https://github.com/ansible/ansible-builder)
> - [Quay.io awx-ee](https://quay.io/repository/ansible/awx-ee?tab=tags&tag=latest)
> - [Quay.io ansible-runner](https://quay.io/repository/ansible/ansible-runner?tab=tags&tag=latest)
{: .new }

### Pip 설치


```bash
wget -O ./get-pip.py https://bootstrap.pypa.io/get-pip.py
python3 get-pip.py
rm get-pip.py
```

```bash
curl -o ./get-pip.py https://bootstrap.pypa.io/get-pip.py
python3 get-pip.py
rm get-pip.py
```

### Python3 --version 3.9 이상

```bash
python3 -m pip install ansible-builder
```

```bash
LTS_TAG=$(curl -s https://github.com/ansible/ansible-builder/releases/ | grep -o 'expanded_assets/.*' | sed 's/expanded_assets\///;s/" >//' | head -n 1)
python3 -m pip install https://github.com/ansible/ansible-builder/archive/"$LTS_TAG".zip
```

```bash
tee collections.yml << EOF
---
version: 1

build_arg_defaults:
  EE_BASE_IMAGE: 'quay.io/ansible/ansible-runner:stable-2.12-latest'

dependencies:
  galaxy: requirements.yml

additional_build_steps:
  prepend: |
    RUN whoami
    RUN cat /etc/os-release
    RUN pip3 install --upgrade pip setuptools
  append:
    - RUN echo This is a post-install command!
    - RUN ls -la /etc
EOF
```

```bash
tee requirements.yml << EOF
---
collections:
- name: community.general
  version: 7.3.0
EOF
```

### `ansible-builder` EE 이미지 생성

```bash
ansible-builder build --tag ansible-awx-ee --container-runtime docker -f collections.yml
```

```bash
Running command:
  docker build -f context/Dockerfile -t ansible-awx-ee context
Complete! The build context can be found at: /root/context
```
