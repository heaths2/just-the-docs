---
layout: default
title: Virt-manager
parent: Blog
grand_parent: Category
permalink: docs/category/blog/72
child_nav_order: desc
---
# Virt-manager
{: .no_toc}

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---
## 개요

> - Virt-manager
> - [Virt-manager]([https://learn.microsoft.com/ko-kr/windows-server/administration/openssh/openssh_install_firstuse](https://virt-manager.org/)) doc
{: .new }

### XEN Hypervisor 설치

```bash
apt-get update
apt-get install xen-system-amd64
apt-get install --no-install-recommends xen-tools
```

### Virt-manager 설치

```bash
apt-get install virt-manager libvirt-daemon-system libvirt-daemon-driver-xen ssh-askpass --no-install-recommends
```

- ssh 연결
```
virsh connect xen+ssh://root@192.168.56.100/system
```

- domxml 변환
```bash
virsh -c xen:///system domxml-from-native xen-xl /etc/xen/node > /etc/xen/node.xml
```

```
e.g node.xml
<domain type='xen'>
  <name>node</name>
  <uuid>a4c87760-529a-4c5a-bc59-1a4f7c724dcc</uuid>
  <memory unit='KiB'>2097152</memory>
  <currentMemory unit='KiB'>1048576</currentMemory>
  <vcpu placement='static'>2</vcpu>
  <bootloader>pygrub</bootloader>
  <os>
    <type arch='x86_64' machine='xenpv'>linux</type>
    <cmdline>/dev/xvda1 iommu=1</cmdline>
  </os>
  <clock offset='utc' adjustment='reset'/>
  <on_poweroff>destroy</on_poweroff>
  <on_reboot>restart</on_reboot>
  <on_crash>restart</on_crash>
  <devices>
    <disk type='file' device='disk'>
      <driver name='qemu' type='raw'/>
      <source file='/dev/Disks/node-swap'/>
      <target dev='xvda1' bus='xen'/>
    </disk>
    <disk type='file' device='disk'>
      <driver name='qemu' type='raw'/>
      <source file='/dev/Disks/node-disk'/>
      <target dev='xvda2' bus='xen'/>
    </disk>
    <controller type='xenbus' index='0'/>
    <interface type='bridge'>
      <mac address='00:00:00:00:00:00'/>
      <source bridge='xenbr0'/>
    </interface>
    <console type='pty'>
      <target type='xen' port='0'/>
    </console>
    <input type='mouse' bus='xen'/>
    <input type='keyboard' bus='xen'/>
    <memballoon model='xen'/>
  </devices>
</domain>
```

- Virt-manager 추가
```bash
virsh define node.xml
# e.g 
Domain node defined from node.xml
```

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/b26c816a-c4f7-411e-9d4b-67c548d9943d)
![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/dc1eca3c-dda8-4e1c-9316-923c183c18b5)
![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/9dadaed8-70b5-4037-bc40-cb20310f04ef)

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/1873c7fb-0ac7-4503-9ae1-54a1f11a2d0b)
