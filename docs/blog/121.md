---
layout: default
title: FortiGate IPSec VPN 설정
parent: Blog
grand_parent: Category
permalink: docs/category/blog/121
child_nav_order: desc
---
# 121
<details open markdown="block">
  <summary>
    Table of contents
  </summary>
  {: .no_toc .text-delta .label .label-green }
1. TOC
{:toc}
</details>
---

## 개요

> - FortiGate IPSec VPN
{: .new }

### Office IPSec VPN Site to Site 설정

- VPN Setup 

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/37dbe149-1d23-488d-845b-0169631b9e36)

- VPN Authentication

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/7bdd4f58-9a69-414d-b454-859a299b1c53)

- VPN Policy & Routing

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/169babe1-c86e-4e97-a386-1bcb6f4067ff)

- Review Settings

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/d43f1e23-c311-456c-b865-fb7f15e38bf9)

- VPN Creation Wizard

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/ad5197c7-689a-4d03-9c38-342f7d7b7afe)

- VPN Refernece

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/5e18e2ba-ccd5-49d4-8650-c0c8b936a999)

- Remote VPN(IDC) → Local VPN(Office) Policy

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
FortiGate # config firewall policy

FortiGate (policy) # edit 14

FortiGate (14) # show
config firewall policy
    edit 14
        set status disable
        set name "vpn_IDC VPN_remote_0"
        set uuid c63b7298-7dfd-51ee-fc08-3eaec003bbba
        set srcintf "IDC VPN"
        set dstintf "internal"
        set action accept
        set srcaddr "IDC VPN_remote"
        set dstaddr "IDC VPN_local"
        set schedule "always"
        set service "ALL"
        set comments "VPN: IDC VPN (Created by VPN wizard)"
    next
end

FortiGate (14) # 
```

</details>
{: .label .label-green }

- Local VPN(Office) → Remote VPN(IDC) Policy

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
FortiGate # config firewall policy

FortiGate (policy) # edit 13

FortiGate (13) # show
config firewall policy
    edit 13
        set status disable
        set name "vpn_IDC VPN_local_0"
        set uuid c6176d80-7dfd-51ee-95ee-0eff193e3d6e
        set srcintf "internal"
        set dstintf "IDC VPN"
        set action accept
        set srcaddr "IDC VPN_local"
        set dstaddr "IDC VPN_remote"
        set schedule "always"
        set service "ALL"
        set comments "VPN: IDC VPN (Created by VPN wizard)"
    next
end

FortiGate (13) # 
```

</details>
{: .label .label-green }

- VPN Static Routing

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
FortiGate # config router static

FortiGate (static) # edit 12

FortiGate (12) # show
config router static
    edit 12
        set device "Office-IDC"
        set comment "VPN: Office-IDC (Created by VPN wizard)"
        set dstaddr "Office-IDC_remote"
    next
end

FortiGate (12) # 
```

</details>
{: .label .label-green }

- VPN Blackhole Static Routing

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
FortiGate # config router static

FortiGate (static) # edit 13

FortiGate (13) # show
config router static
    edit 13
        set distance 254
        set comment "VPN: Office-IDC (Created by VPN wizard)"
        set blackhole enable
        set dstaddr "Office-IDC_remote"
    next
end

FortiGate (13) # 
```

</details>
{: .label .label-green }

### IDC IPSec VPN Custom 설정

- VPN Creation Wizard

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/4587b8f7-53e9-4888-a317-e367c54a14b0)

- VPN Custom

![image](https://github.com/heaths2/heaths2.github.io/assets/36792594/cc6f2f7b-e003-4456-ac89-a69b4b25b32f)

- Local VPN(IDC) → Remote VPN(Office) Policy

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
FortiGate # config firewall policy

FortiGate (policy) # edit "161"

FortiGate (161) # show
config firewall policy
    edit 161
        set uuid bf378f0e-7e02-51ee-07db-32e491b15e04
        set srcintf "Interanl"
        set dstintf "IDC-8F"
        set action accept
        set srcaddr "IDC-8F_local"
        set dstaddr "IDC-8F_remote"
        set schedule "always"
        set service "ALL"
        set logtraffic all
    next
end

FortiGate (161) # 
```

</details>
{: .label .label-green }

- Remote VPN(IDC) → Local VPN(Office) Policy

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
FortiGate # config firewall policy

FortiGate (policy) # edit "157"

FortiGate (157) # show
config firewall policy
    edit 157
        set uuid 6eff46cc-7e01-51ee-ae1d-7826b8896fc7
        set srcintf "IDC-8F"
        set dstintf "Interanl"
        set action accept
        set srcaddr "IDC-8F_remote"
        set dstaddr "IDC-8F_local"
        set schedule "always"
        set service "ALL"
        set logtraffic all
        set comments "VPN: IDC-8F (Created by VPN wizard)"
    next
end

FortiGate (157) # 
```

</details>
{: .label .label-green }

- VPN Static Routing

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
FortiGate # config router static

FortiGate (static) # edit 2

FortiGate (2) # show
config router static
    edit 2
        set device "IDC-8F"
        set comment "VPN: IDC-8F (Created by VPN wizard)"
        set dstaddr "IDC-8F_remote"
    next
end

FortiGate (2) # 
```

</details>
{: .label .label-green }

- VPN Blackhole Static Routing

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
FortiGate # config router static

FortiGate (static) # edit 3

FortiGate (3) # show
config router static
    edit 3
        set comment "VPN: IDC-8F (Created by VPN wizard)"
        set blackhole enable
        set dstaddr "IDC-8F_remote"
        set vrf 0
    next
end

FortiGate (3) # 
```

</details>
{: .label .label-green }
