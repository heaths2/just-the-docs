---
layout: default
title: Gateway 설정
parent: Blog
grand_parent: Category
permalink: docs/category/blog/118
child_nav_order: desc
---
# Gateway 설정
<details open markdown="block">
  <summary>
    Table of contents
  </summary>
  {: .no_toc .text-delta .label .label-green }
1. TOC
{:toc}
</details>
---

## 개요

> - 2개의 Gateway 설정
{: .new }

### Gateway 설정

- 네트워크 설정 정의 YAML 파일 작성

```bash
/etc/netplan/00-installer-config.yaml
```

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }
  
```bash
# This is the network config written by 'subiquity'
network:
  version: 2
  renderer: networkd
  ethernets:
    enp0s3:
      dhcp4: false
      dhcp6: false
      optional: true
      addresses: [ 192.168.0.35/24 ]
      gateway4: 192.168.0.1
      nameservers:
        addresses: [ 164.124.101.2, 210.220.163.82, 1.1.1.1, 8.8.8.8 ]
      routes:
        - to: 0.0.0.0/0
          via: 192.168.0.1
          metric: 100
          table: 101
      routing-policy:
        - from: 192.168.0.0/24
          table: 101
    enp0s8:
      dhcp4: false
      dhcp6: false
      optional: true
      addresses: [ 172.16.0.6/24 ]
      gateway4: 172.16.0.1
      nameservers:
        addresses: [ 164.124.101.2, 210.220.163.82, 1.1.1.1, 8.8.8.8 ]
```

</details>
{: .label .label-green }

- 네트워크 설정 적용

```bash
netplan apply
```

- 네트워크 서비스 재시작

```bash
systemctl restart systemd-networkd.service
```

- `enp0s3` NIC Ping 테스트

```bash
ping -w 1 8.8.8.8 -I enp0s3
```

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }

```bash
PING 8.8.8.8 (8.8.8.8) from 192.168.0.35 enp0s3: 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=56 time=34.0 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 34.003/34.003/34.003/0.000 ms
```

</details>
{: .label .label-green }

- `enp0s8` NIC Ping 테스트

```bash
ping -w 1 8.8.8.8 -I enp0s8
```

<details markdown="block">
  <summary>
    코드
  </summary>
  {: .text-delta }

```bash
PING 8.8.8.8 (8.8.8.8) from 172.16.0.6 enp0s8: 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=55 time=32.2 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 32.240/32.240/32.240/0.000 ms
```

> Gateway 메트릭 설정 안된 경우
```bash
PING 8.8.8.8 (8.8.8.8) from 172.16.0.6 enp0s8: 56(84) bytes of data.

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 0ms
```
>
{: .important}

</details>
{: .label .label-green }
